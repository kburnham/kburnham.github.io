crime <- read.csv("http://datasets.flowingdata.com/crimeRatesByState-formatted.csv")
crime <- read.csv("http://datasets.flowingdata.com/crimeRatesByState-formatted.csv")
crime.new <- crime[crime$state != "District of Columbia",]
crime.new <- crime.new[crime.new$state != "United States ",]
boxplot(crime.new$robbery, horizontal=TRUE, main="Robbery Rates in US")
boxplot(crime.new[,-1], horizontal=TRUE, main="Crime Rates in US")
hist(crime.new$robbery, breaks=10)
par(mfrow=c(3, 3))
colnames <- dimnames(crime.new)[[2]]
for (i in 2:8) {
hist(crime[,i], xlim=c(0, 3500), breaks=seq(0, 3500, 100), main=colnames[i], probability=TRUE, col="gray", border="white")
}
par(mfrow=c(3, 3))
colnames <- dimnames(crime.new)[[2]]
for (i in 2:8) {
hist(crime[,i], xlim=c(0, 3500), breaks=seq(0, 3500, 100), main=colnames[i], probability=TRUE, col="gray", border="white")
}
There are a lot of ways to show distributions, but for the purposes of this tutorial, I'm only going to cover the more traditional plot types like histograms and box plots. Otherwise, we could be here all night. Plus the basic distribution plots aren't exactly well-used as it is.
Before you get into plotting in R though, you should know what I mean by distribution. It's basically the spread of a dataset. For example, the median of a dataset is the half-way point. Half of the values are less than the median, and the other half are greater than. That's only part of the picture.
What happens in between the maximum value and median? Do the values cluster towards the median and quickly increase? Are there are lot of values clustered towards the maximums and minimums with nothing in between? Sometimes the variation in a dataset is a lot more interesting than just mean or median. Distribution plots help you see what's going on.
Want more? Google and Wikipedia are your friend.Anyways, that's enough talking. Let's make some charts.
If you don't have R installed yet, do that now.
Box-and-Whisker Plot
This old standby was created by statistician John Tukey in the age of graphing with pencil and paper. I wrote a short guide on how to read them a while back, but you basically have the median in the middle, upper and lower quartiles, and upper and lower fences. If there are outliers more or less than 1.5 times the upper or lower quartiles, respectively, they are shown with dots.
The method might be old, but they still work for showing basic distribution. Obviously, because only a handful of values are shown to represent a dataset, you do lose the variation in between the points.
To get started, load the data in R. You'll use state-level crime data from the Chernoff faces tutorial.
# Load crime data
crime <- read.csv("http://datasets.flowingdata.com/crimeRatesByState-formatted.csv")
Remove the District of Columbia from the loaded data. Its city-like makeup tends to throw everything off.
# Remove Washington, D.C.
crime.new <- crime[crime$state != "District of Columbia",]
Oh, and you don't need the national averages for this tutorial either.
# Remove national averages
crime.new <- crime.new[crime.new$state != "United States ",]
Now all you have to do to make a box plot for say, robbery rates, is plug the data into boxplot().
# Box plot
boxplot(crime.new$robbery, horizontal=TRUE, main="Robbery Rates in US")
Want to make box plots for every column, excluding the first (since it's non-numeric state names)? That's easy, too. Same function, different argument.
# Box plots for all crime rates
boxplot(crime.new[,-1], horizontal=TRUE, main="Crime Rates in US")
Multiple box plot for comparision.
Histogram
Like I said though, the box plot hides variation in between the values that it does show. A histogram can provide more details. Histograms look like bar charts, but they are not the same. The horizontal axis on a histogram is continuous, whereas bar charts can have space in between categories.
Just like boxplot(), you can plug the data right into the hist() function. The breaks argument indicates how many breaks on the horizontal to use.
# Histogram
hist(crime.new$robbery, breaks=10)
Look, ma! It's not a a bar chart.
Using the hist() function, you have to do a tiny bit more if you want to make multiple histograms in one view. Iterate through each column of the dataframe with a for loop. Call hist() on each iteration.
# Multiple histograms
par(mfrow=c(3, 3))
colnames <- dimnames(crime.new)[[2]]
for (i in 2:8) {
hist(crime[,i], xlim=c(0, 3500), breaks=seq(0, 3500, 100), main=colnames[i], probability=TRUE, col="gray", border="white")
}
Using the same scale for each makes it easy to compare distributions.
Density Plot
For smoother distributions, you can use the density plot. You should have a healthy amount of data to use these or you could end up with a lot of unwanted noise.
To use them in R, it's basically the same as using the hist() function. Iterate through each column, but instead of a histogram, calculate density, create a blank plot, and then draw the shape.
# Density plot
par(mfrow=c(3, 3))
colnames <- dimnames(crime.new)[[2]]
for (i in 2:8) {
d <- density(crime[,i])
plot(d, type="n", main=colnames[i])
polygon(d, col="red", border="gray")
}
par(mfrow=c(3, 3))
colnames <- dimnames(crime.new)[[2]]
for (i in 2:8) {
hist(crime[,i], xlim=c(0, 3500), breaks=seq(0, 3500, 100), main=colnames[i], probability=TRUE, col="gray", border="white")
}
par(mfrow=c(3, 3))
colnames <- dimnames(crime.new)[[2]]
for (i in 2:8) {
hist(crime[,i], xlim=c(0, 3500), breaks=seq(0, 3500, 100), main=colnames[i], probability=TRUE, col="gray", border="white")
d <- density(crime[,i])
lines(d, col="red")
}
par(mfrow=c(3, 3))
colnames <- dimnames(crime.new)[[2]]
for (i in 2:8) {
hist(crime[,i], xlim=c(0, 3500), breaks=seq(0, 3500, 100), main=colnames[i], probability=TRUE, col="gray", border="white")
d <- density(crime[,i])
lines(d, col="red")
}
d <- density(crime$robbery)
plot(d, type="n", main="robbery")
polygon(d, col="lightgray", border="gray")
rug(crime$robbery, col="red")
library(vioplot)
vioplot(crime.new$robbery, horizontal=TRUE, col="gray")
library(foreign)
library(memisc)
library(ggplot2)
library(dplyr)
library(tidyr)
setwd("/Users/kb/Documents/MOOCs/datascience/DataVis/FinalProject_DV/kburnham.github.io")
#data <- read.spss("Pew Research Global Attitudes Project Spring 2013 Dataset for web.sav", to.data.frame = True)
data <- as.data.set(spss.system.file("Pew Research Global Attitudes Project Spring 2013 Dataset for web.sav"))
data <- as.data.frame(data)
data <- subset(data, country != "United States")
data <- subset(data, country != "China")
americas <- c("Canada", "Argentina", "Bolivia", "Brazil", "Chile", "El Salvador",
"Mexico", "Venezuela" )
europe <- c("Spain", "Czech Republic", "France", "Germany", "Spain", "Russia",
"Britain", "Greece", "Poland", "Italy")
asia <- c("South Korea", "Australia", "Turkey", "Lebanon", "Japan", "Malaysia",
"Indonesia", "Phillipines", "Pakistan", "Palestinian territories")
africa <- c("Egypt", "Senegal", "Nigeria", "Kenya", "Uganda", "Jordan", "Tunisia",
"Ghana", "South Africa", "Israel")
data$region <- NA
data$region[data$country %in% americas] <- "Americas"
data$region[data$country %in% europe] <- "Europe"
data$region[data$country %in% asia] <- "Asia/Pacific"
data$region[data$country %in% africa] <- "Africa"
data$region <- as.factor(data$region)
summary(data$region)
unique(data$country)
data$country
data$country[data$region == NA]
summary(data$country)
data$country[is.na(data$region)]
americas <- c("Canada", "Argentina", "Bolivia", "Brazil", "Chile", "El Salvador",
"Mexico", "Venezuela" )
europe <- c("Spain", "Czech Republic", "France", "Germany", "Spain", "Russia",
"Britain", "Greece", "Poland", "Italy")
asia <- c("South Korea", "Australia", "Turkey", "Lebanon", "Japan", "Malaysia",
"Indonesia", "Philipines", "Pakistan", "Palestinian territories")
africa <- c("Egypt", "Senegal", "Nigeria", "Kenya", "Uganda", "Jordan", "Tunisia",
"Ghana", "South Africa", "Israel")
data$region <- NA
data$region[data$country %in% americas] <- "Americas"
data$region[data$country %in% europe] <- "Europe"
data$region[data$country %in% asia] <- "Asia/Pacific"
data$region[data$country %in% africa] <- "Africa"
data$region <- as.factor(data$region)
summary(data$region)
americas <- c("Canada", "Argentina", "Bolivia", "Brazil", "Chile", "El Salvador",
"Mexico", "Venezuela" )
europe <- c("Spain", "Czech Republic", "France", "Germany", "Spain", "Russia",
"Britain", "Greece", "Poland", "Italy")
asia <- c("South Korea", "Australia", "Turkey", "Lebanon", "Japan", "Malaysia",
"Indonesia", "Philippines", "Pakistan", "Palestinian territories")
africa <- c("Egypt", "Senegal", "Nigeria", "Kenya", "Uganda", "Jordan", "Tunisia",
"Ghana", "South Africa", "Israel")
data$region <- NA
data$region[data$country %in% americas] <- "Americas"
data$region[data$country %in% europe] <- "Europe"
data$region[data$country %in% asia] <- "Asia/Pacific"
data$region[data$country %in% africa] <- "Africa"
data$region <- as.factor(data$region)
summary(data$region)
unique(data$country)
christian <- c("Czech Republic", "South Korea", "Canada", "France", "Germany", "Spain",
"Mexico", "Chile", "Australia", "Russia", "Britain", "Greece", "Poland",
"Italy", "Brazil", "Kenya", "Uganda", "Argentina", "Philippines",
"Ghana", "South Africa", "Bolvia", "Venezuela", "El Salvador")
muslim <- c("Turkey", "Egypt", "Senegal", "Lebanon", "Nigeria", "Malaysia", "Indonesia",
"Jordan", "Tunisia", "Pakistan", "Palestinian territories")
budhist <- c("Japan")
jewish <- c("Israel")
data$main.religion <- "Other"
data$main.religion[data$country %in% christian] <- "Christian"
data$main.religion[data$country %in% muslim] <- "Muslim"
data$main.religion[data$country %in% budhist] <- "Buddhist"
data$main.religion[data$country %in% jewish] <- "Jewish"
data$main.religion <as.factor(data$main.religion)
summary(data$main.religion)
data$main.religion <- as.factor(data$main.religion)
summary(data$main.religion)
library(foreign)
library(memisc)
library(ggplot2)
library(dplyr)
library(tidyr)
setwd("/Users/kb/Documents/MOOCs/datascience/DataVis/FinalProject_DV/kburnham.github.io")
#data <- read.spss("Pew Research Global Attitudes Project Spring 2013 Dataset for web.sav", to.data.frame = True)
data <- as.data.set(spss.system.file("Pew Research Global Attitudes Project Spring 2013 Dataset for web.sav"))
data <- as.data.frame(data)
summary(data$q55jap)
countries <- unique(data$country)
countries
for (country in countries)
{
print(country)
}
for (country in countries)
{
print(country)
print substr(country, 1, 3)
}
substr(country,1,3)
for (country in countries)
{
print substr(country, 1, 3)
}
for (country in countries)
{
print(substr(country, 1, 3))
}
for (country in countries)
{
print(tolower(substr(country, 1, 3)))
}
names(data)
View(data)
View(data)
data[1]
data[country == "Australia"]
data[country = "Australia"]
data[data$country = "Australia"]
data[data$country == "Australia"]
summary(data$country)
data$country[data$country == "United States"]
data$country[data$country == "Australia"]
data[data$country == "Australia"]
data$q24[data$country == "Australia"]
data[data$country == "Australia"]
data$q55ausa[data$country == "Australia"]
data$q55ausb[data$country == "Australia"]
data[data$country == "Australia"]
data[data$country == "Australia",]
names(data)
countries
data$prefix <- tolower(substr(data$country, 1, 3))
summary(data$prefix)
data$prefix <- as.factor(data$prefix)
summary(data$prefix)
data$prefix(data$country == "Chile") <- "chl"
data$prefix(data$country == "Chile",) <- "chl"
data$country(data$country == "Chile")
data$country[data$country == "Chile"]
data$prefix[data$country == "Chile"]
data$prefix[data$country == "Chile"] <- "chl"
data$prefix <- factor(data$prefix, c(levels(data$prefix), "chl", "esa", "indo",
"mala", "rsa", "skor"))
data$prefix[data$country == "Chile"] <- "chl"
data$prefix[data$country == "El Salvador"] <- "esa"
data$prefix[data$country == "Indonesia"] <- "indo"
data$prefix[data$country == "Malaysia"] <- "mala"
data$prefix[data$country == "South Africa"] <- "rsa"
data$prefix[data$country == "South Korea"] <- "skor"
summary(data$prefix)
data$religion <- NA
data$prefix[data$country == "Chile"]
prefix <- tolower(substr(data$country, 1, 3))
prefixes <- unique(data$prefix)
country.prefixes <- cbind(countries, prefixes)
View(country.prefixes)
View(country.prefixes)
for (prefix in prefixes)
{
paste("q55", prefix)
}
for (prefix in prefixes)
{
print(paste("q55", prefix))
}
?paste
for (prefix in prefixes)
{
print(paste("q55", prefix, sep=""))
}
View(data)
View(data)
View(data)
View(data)
names(data)
write.table(data, "muslim.attitudes.to.USA.China.csv", sep = ",", col.names = NA)
names(data)
summary(data$relig)
